<?xml version="1.0" standalone="yes"?>
<!-- Generated by BEAUTi v1.8.0                                              -->
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       David Geffen School of Medicine, University of California, Los Angeles-->
<!--       http://beast.bio.ed.ac.uk/                                        -->
<beast>
  <!-- The list of taxa to be analysed (can also include dates/ages).          -->
  <!-- ntax=4                                                                  -->
  <taxa id="taxa">
    <taxon id="IGHV1-18*01"/>
    <taxon id="04-A-M_0484413"/>
  </taxa>
  <taxa id="taxa.0">
    <taxon idref="IGHV1-18*01"/>
    <taxon idref="04-A-M_0484413"/>
  </taxa>
  <alignment id="alignment.0" dataType="nucleotide">
    <sequence><taxon idref="IGHV1-18*01"/>
      CAGGTTCAGCTGGTGCAGTCTGGAGCTGAGGTGAAGAAGCCTGGGGCCTCAGTGAAGGTCTCCTGCAAGGCTTCTGGTTACACCTTTACCAGCTATGGTATCAGCTGGGTGCGACAGGCCCCTGGACAAGGGCTTGAGTGGATGGGATGGATCAGCGCTTACAATGGTAACACAAACTATGCACAGAAGCTCCAGGGCAGAGTCACCATGACCACAGACACATCCACGAGCACAGCCTACATGGAGCTGAGGAGCCTGAGATCTGACGACACGGCCGTGTATTACTGTGCGAGA
		</sequence>
    <sequence><taxon idref="04-A-M_0484413"/>
      ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------NNCAGGGCAGAGTCACCATGACCACAGACACATCCACGAGCACAGCCCACCTGGAACTGAAGAGCCTGAGATCTGACGACACGGCCGTGTATTTCTGTGCGCGA
		</sequence>
  </alignment>
  <patterns id="CP1.patterns.0" from="1" every="3" unique="false">
    <alignment idref="alignment.0"/>
  </patterns>
  <patterns id="CP2.patterns.0" from="2" every="3" unique="false">
    <alignment idref="alignment.0"/>
  </patterns>
  <patterns id="CP3.patterns.0" from="3" every="3" unique="false">
    <alignment idref="alignment.0"/>
  </patterns>
  <!-- A prior assumption that the population size has remained constant       -->
  <!-- throughout the time spanned by the genealogy.                           -->
  <!-- Generate a tree model                                                   -->
  <newick id="newick">('IGHV1-18*01':0.025,'04-A-M_0484413':0.025);</newick>
  <treeModel id="treeModel.0">
    <newick idref="newick"/>
    <rootHeight>
      <parameter id="treeModel.0.rootHeight" />
    </rootHeight>
    <nodeHeights internalNodes="true">
      <parameter id="treeModel.0.internalNodeHeights"/>
    </nodeHeights>
    <nodeHeights internalNodes="true" rootNode="true">
      <parameter id="treeModel.0.allInternalNodeHeights"/>
    </nodeHeights>
  </treeModel>
  <!-- The strict clock (Uniform rates across branches)                        -->
  <strictClockBranchRates id="branchRates">
    <rate>
      <parameter id="clock.rate" value="1.0"/>
    </rate>
  </strictClockBranchRates>
  <!-- The HKY substitution model (Hasegawa, Kishino & Yano, 1985)             -->
  <HKYModel id="CP1.hky">
    <frequencies>
      <frequencyModel dataType="nucleotide">
        <frequencies>
          <parameter id="CP1.frequencies" value="0.25 0.25 0.25 0.25"/>
        </frequencies>
      </frequencyModel>
    </frequencies>
    <kappa>
      <parameter id="CP1.kappa" value="2.0" lower="0.0"/>
    </kappa>
  </HKYModel>
  <!-- The HKY substitution model (Hasegawa, Kishino & Yano, 1985)             -->
  <HKYModel id="CP2.hky">
    <frequencies>
      <frequencyModel dataType="nucleotide">
        <frequencies>
          <parameter id="CP2.frequencies" value="0.25 0.25 0.25 0.25"/>
        </frequencies>
      </frequencyModel>
    </frequencies>
    <kappa>
      <parameter id="CP2.kappa" value="2.0" lower="0.0"/>
    </kappa>
  </HKYModel>
  <!-- The HKY substitution model (Hasegawa, Kishino & Yano, 1985)             -->
  <HKYModel id="CP3.hky">
    <frequencies>
      <frequencyModel dataType="nucleotide">
        <frequencies>
          <parameter id="CP3.frequencies" value="0.25 0.25 0.25 0.25"/>
        </frequencies>
      </frequencyModel>
    </frequencies>
    <kappa>
      <parameter id="CP3.kappa" value="2.0" lower="0.0"/>
    </kappa>
  </HKYModel>
  <!-- site model                                                              -->
  <siteModel id="CP1.siteModel">
    <substitutionModel>
      <HKYModel idref="CP1.hky"/>
    </substitutionModel>
    <relativeRate>
      <parameter id="CP1.mu" value="1.0" lower="0.0"/>
    </relativeRate>
  </siteModel>
  <!-- site model                                                              -->
  <siteModel id="CP2.siteModel">
    <substitutionModel>
      <HKYModel idref="CP2.hky"/>
    </substitutionModel>
    <relativeRate>
      <parameter id="CP2.mu" value="1.0" lower="0.0"/>
    </relativeRate>
  </siteModel>
  <!-- site model                                                              -->
  <siteModel id="CP3.siteModel">
    <substitutionModel>
      <HKYModel idref="CP3.hky"/>
    </substitutionModel>
    <relativeRate>
      <parameter id="CP3.mu" value="1.0" lower="0.0"/>
    </relativeRate>
  </siteModel>
  <compoundParameter id="allMus">
    <parameter idref="CP1.mu"/>
    <parameter idref="CP2.mu"/>
    <parameter idref="CP3.mu"/>
  </compoundParameter>
  <!-- Likelihood for tree given sequence data                                 -->
  <ancestralTreeLikelihood id="CP1.treeLikelihood.0" useAmbiguities="false" stateTagName="CP1.states0">
    <patterns idref="CP1.patterns.0"/>
    <treeModel idref="treeModel.0"/>
    <siteModel idref="CP1.siteModel"/>
    <strictClockBranchRates idref="branchRates"/>
  </ancestralTreeLikelihood>
  <ancestralTreeLikelihood id="CP2.treeLikelihood.0" useAmbiguities="false" stateTagName="CP2.states0">
    <patterns idref="CP2.patterns.0"/>
    <treeModel idref="treeModel.0"/>
    <siteModel idref="CP2.siteModel"/>
    <strictClockBranchRates idref="branchRates"/>
  </ancestralTreeLikelihood>
  <ancestralTreeLikelihood id="CP3.treeLikelihood.0" useAmbiguities="false" stateTagName="CP3.states0">
    <patterns idref="CP3.patterns.0"/>
    <treeModel idref="treeModel.0"/>
    <siteModel idref="CP3.siteModel"/>
    <strictClockBranchRates idref="branchRates"/>
  </ancestralTreeLikelihood>
  <!-- Define operators                                                        -->
  <operators id="operators" optimizationSchedule="default">
    <scaleOperator scaleFactor="0.75" weight="3">
      <parameter idref="treeModel.0.rootHeight"/>
    </scaleOperator>
    <!--<upDownOperator scaleFactor="0.75" weight="3">-->
      <!--<up>-->
			<!--</up>-->
      <!--<down>-->
        <!--<parameter idref="treeModel.0.allInternalNodeHeights"/>-->
      <!--</down>-->
    <!--</upDownOperator>-->
  </operators>
  <!-- START Ancestral state reconstruction                                    -->
  <!-- Robust counting                                                         -->
  <codonPartitionedRobustCounting id="robustCounting0.S" labeling="S" useUniformization="true" unconditionedPerBranch="true">
    <treeModel idref="treeModel.0"/>
    <firstPosition>
      <ancestralTreeLikelihood idref="CP1.treeLikelihood.0"/>
    </firstPosition>
    <secondPosition>
      <ancestralTreeLikelihood idref="CP2.treeLikelihood.0"/>
    </secondPosition>
    <thirdPosition>
      <ancestralTreeLikelihood idref="CP3.treeLikelihood.0"/>
    </thirdPosition>
  </codonPartitionedRobustCounting>
  <codonPartitionedRobustCounting id="robustCounting0.N" labeling="N" useUniformization="true" unconditionedPerBranch="true">
    <treeModel idref="treeModel.0"/>
    <firstPosition>
      <ancestralTreeLikelihood idref="CP1.treeLikelihood.0"/>
    </firstPosition>
    <secondPosition>
      <ancestralTreeLikelihood idref="CP2.treeLikelihood.0"/>
    </secondPosition>
    <thirdPosition>
      <ancestralTreeLikelihood idref="CP3.treeLikelihood.0"/>
    </thirdPosition>
  </codonPartitionedRobustCounting>
  <!-- END Ancestral state reconstruction                                      -->
  <!-- Define MCMC                                                             -->
  <report type="TEXT" title="Report">
    <string>Root height: </string>
    <parameter idref="treeModel.0.rootHeight"/>

  </report>
  <mcmc id="mcmc" chainLength="20000" autoOptimize="true" operatorAnalysis="A-4-0.ops">
    <posterior id="posterior">
      <prior id="prior">
        <logNormalPrior mean="1.0" stdev="1.25" offset="0.0" meanInRealSpace="false">
          <parameter idref="CP1.kappa"/>
        </logNormalPrior>
        <logNormalPrior mean="1.0" stdev="1.25" offset="0.0" meanInRealSpace="false">
          <parameter idref="CP2.kappa"/>
        </logNormalPrior>
        <logNormalPrior mean="1.0" stdev="1.25" offset="0.0" meanInRealSpace="false">
          <parameter idref="CP3.kappa"/>
        </logNormalPrior>
        <!-- Improper uniform prior: CP1.mu                                          -->
        <!-- Improper uniform prior: CP2.mu                                          -->
        <!-- Improper uniform prior: CP3.mu                                          -->
        <uniformPrior lower="0.0" upper="1.0">
          <parameter idref="CP1.frequencies"/>
        </uniformPrior>
        <uniformPrior lower="0.0" upper="1.0">
          <parameter idref="CP2.frequencies"/>
        </uniformPrior>
        <uniformPrior lower="0.0" upper="1.0">
          <parameter idref="CP3.frequencies"/>
        </uniformPrior>
        <exponentialPrior scale="10.0" offset="0.0">
          <parameter idref="treeModel.0.rootHeight"/>
        </exponentialPrior>
      </prior>
      <likelihood id="likelihood">
        <ancestralTreeLikelihood idref="CP1.treeLikelihood.0"/>
        <ancestralTreeLikelihood idref="CP2.treeLikelihood.0"/>
        <ancestralTreeLikelihood idref="CP3.treeLikelihood.0"/>
      </likelihood>
    </posterior>
    <operators idref="operators"/>
    <!-- write log to screen                                                     -->
    <log id="screenLog" logEvery="1000">
      <column label="Posterior" dp="4" width="12">
        <posterior idref="posterior"/>
      </column>
      <column label="Prior" dp="4" width="12">
        <prior idref="prior"/>
      </column>
      <column label="Likelihood" dp="4" width="12">
        <likelihood idref="likelihood"/>
      </column>
      <column label="clock.rate" sf="6" width="12">
        <parameter idref="clock.rate"/>
      </column>
    </log>
    <!-- write log to file                                                       -->

    <log id="fileLog" logEvery="20" fileName="A-4-0.log" overwrite="false">
      <posterior idref="posterior"/>
      <prior idref="prior"/>
      <likelihood idref="likelihood"/>
      <parameter idref="treeModel.0.rootHeight"/>
      <parameter idref="CP1.kappa"/>
      <parameter idref="CP2.kappa"/>
      <parameter idref="CP3.kappa"/>
      <parameter idref="CP1.frequencies"/>
      <parameter idref="CP2.frequencies"/>
      <parameter idref="CP3.frequencies"/>
      <compoundParameter idref="allMus"/>
      <parameter idref="clock.rate"/>
      <!-- START Ancestral state reconstruction                                    -->
      <codonPartitionedRobustCounting idref="robustCounting0.S"/>
      <codonPartitionedRobustCounting idref="robustCounting0.N"/>
      <!-- END Ancestral state reconstruction                                      -->
      <ancestralTreeLikelihood idref="CP1.treeLikelihood.0"/>
      <ancestralTreeLikelihood idref="CP2.treeLikelihood.0"/>
      <ancestralTreeLikelihood idref="CP3.treeLikelihood.0"/>
    </log>
    <!-- write tree log to file                                                  -->
    <logTree id="treeFileLog" logEvery="20" nexusFormat="true" fileName="test.trees">
      <treeModel idref="treeModel.0"/>
      <posterior idref="posterior" />
    </logTree>
    <!-- START Ancestral state reconstruction                                    -->
    <!-- Robust counting for: input1                                             -->
    <log id="fileLog_dNdS" logEvery="20" fileName="A-4-0.dNdS.log">
      <dNdSLogger id="dNdS1_N" counts="true" smooth="false" synonymous="false">
        <treeModel idref="treeModel.0"/>
        <codonPartitionedRobustCounting idref="robustCounting0.S"/>
        <codonPartitionedRobustCounting idref="robustCounting0.N"/>
      </dNdSLogger>
      <dNdSLogger id="dNdS_S" counts="true" synonymous="true" smooth="false">
        <treeModel idref="treeModel.0"/>
        <codonPartitionedRobustCounting idref="robustCounting0.S"/>
        <codonPartitionedRobustCounting idref="robustCounting0.N"/>
      </dNdSLogger>
    </log>
    <!-- END Ancestral state reconstruction                                      -->
  </mcmc>
  <!-- START Ancestral state reconstruction                                    -->
  <report>
    <property name="timer">
      <mcmc idref="mcmc"/>
    </property>
  </report>
</beast>
